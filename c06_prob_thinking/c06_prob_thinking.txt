=== 1. הסתברות מותנית ===

יש הרבה דרכים שהסתברות וסטטיסטיקה יכולות להטעות אותנו. ושום קורס שעוסק שבהן, לא שלם בלי לתת לפחות אזהרה, לגבי התופעות האלה.
ביחידה זו נתמקד בשלוש דרכים שנתונים יכולים להטעות אם לא מסתכלים עליהם בצורה מקיפה ונכונה. אנחנו קוראים לזה: חשיבה הסתברותית.

:::

הסתברות בכלל היא מושג לא קל לתפיסה. הרי במציאות דברים מתרחשים או לא מתרחשים, אז מה המשמעות של המשפט מחר ירד גשם בסיכוי 80 אחוז. ואם אנשים לא מצטיינים בפירוש אמירות הסתברותיות, כשזה נוגע להסתברות מותנית התפיסה שלנו עלולה להטעות אותנו אפילו יותר.

:::

ניזכר בשלוש ההתפלגויות האמפיריות שלמדנו עליהן: ההתפלגות השולית, המרג'ינל, של X ושל Y. ההתפלגות המשותפת, הג'וינט, שהיא בעצם הסתברות החיתוך. וההסתברות המותנית, הקונדישיונל - אם ידוע לי שX קיבל ערך מסוים, מה כעת ההסתברות שY יקבל ערך אחר, האם היא שונה.

כאמור הכי מעניינת אותנו היא ההסתברות המותנית.

:::

ניזכר גם בטבלת השכיחות של שני משתנים בדידים X ו-Y. אפשר לחלץ כל הסתברות מטבלה זו. השוליות של X ושל Y נמצאות אכן בשוליים, והן הסכום של השורה או של העמודה.

ההתפלגות המשותפת נמצאת בתוך התאים, כל תא מתאר את הסתברות החיתוך של מאורע העמודה ומאורע השורה.

וההתפלגות המותנית לפי חוק בייס היא ההסתברות המשותפת בכל שורה, מחולקת בהסתברות השורה. או ההסתברות המשותפת בכל עמודה, מחולקת בהסתברות העמודה.

:::

ואם כבר הזכרנו את חוק בייס נכתוב אותו שוב במפורש: ההסתברות המותנית Y שווה ל-y קטן, בהינתן שX קיבל ערך x ספציפי, היא הסתברות החיתוך חלקי ההסתברות השולית של X. וזה אומר ההסתברות המותנית ההפוכה של X בהינתן Y, כפול ההסתברות של Y, חלקי ההסתברות השולית של X.

הרבה פעמים ההסתברות השולית של X שנמצאת במכנה מצריכה עוד חישוב באמצעות איסוף של הסתברויות מותנות באמצעות נוסחת ההסתברות השלמה, שהיא בעצם ממוצע משוקלל של הסתברויות מותנות.

אפשר לשלב בין שני החוקים, באמצעות הצבת נוסחת ההסתברות השלמה במכנה של חוק בייס.

וכך קיבלנו קשר בין ההסתברות של Y בהינתן X להסתברות של X בהינתן Y.

:::

אז בואו ניתן דוגמא לכמה מתעתעת הסתברות מותנית יכולה להיות.

נניח שיש לנו בדיקה לנגיף הקורונה. ונתון לנו שהבדיקה מדויקת מאוד. כמה מדויקת? 99 אחוז מהנשאים של הנגיף יקבלו תשובה חיובית, ו-99 אחוז מהאנשים הבריאים יקבלו תשובה שלילית!

אבל נשאלת השאלה: נניח שקיבלתי תשובה חיובית. מה הסיכוי שאני באמת נשא של הנגיף? רוב האנשים יגידו מיד "סיכוי גבוה מאוד". הבדיקה הרי כל כך מדויקת. יכול להיות שהם צודקים. אבל אם נפרמל את הנתונים שקיבלנו נראה שאי אפשר לדעת, ולמעשה יכול להיות שהסיכוי שאני נשא של הנגיף אם קיבלתי תשובה חיובית - הוא נמוך מאוד.

למשל, מה אם אוסיף את טבלת השכיחות הבאה, בלי הסתברויות, עם כמויות מוחלטות:

כעת אנחנו רואים שהנגיף נדיר למדי. הסיכוי להיות נשא הוא 1 לאלף! הנתונים עצמם לא משקרים: חשבו ותראו שאכן מתוך 100 אלף אנשים בריאים 99 אחוז יקבלו תשובה שלילית, ומתוך 100 חולים, 99 אחוז יקבלו תשובה חיובית. אבל מה ההסתברות המבוקשת? מתוך 1099 אנשים שיקבלו תשובה חיובית רק 99 חולים! כלומר פחות מעשרה אחוזים!

כלומר למרות שהבדיקה מדויקת מאוד, אם המחלה נדירה ההסתברות שאת באמת נשאית אם קיבלת בדיקה חיובית היא נמוכה!
:::

אז בואו נראה את זה בצורה קצת יותר פורמלית.

נגדיר שני משתני ברנולי: Y יהיה נשא נגיף או לא, 1 או אפס. X יהיה בדיקה חיובית או לא, 1 או אפס.

הנתון של 99 אחוז תשובה חיובית אם אתה חולה, ו-99 אחוז בדיקה שלילית אם אתה לא, נרשום כך: ההסתברות שX הבדיקה הוא 1 בהינתן Y 1 היא 0.99, וההסתברות המותנית שX שווה 0 בהינתן Y שווה 0 היא 0.99. כמו-כן הנתון שהמחלה נדירה כל כך מיתרגם לסיכוי שY שווה 1, הוא 0.001 או 1 לאלף.

ההסתברות המבוקשת, היא שY, מצב הנבדק יהיה שווה 1 בהינתן שהבדיקה X חיובית, היא 1. לפי חוק בייס במונה יש לנו את ההסתברות ההפוכה שX שווה ל1 בהינתן Y שווה 1, היא 0.99, כפול המשקולת המאוד קטנה שY שווה 1, 1 לאלף. במכנה אנחנו רוצים את ההסתברות הכללית לקבל תשובה חיובית. לפי נוסחת ההסתברות השלמה זה שווה לסיכוי להיות חולה כפול הסיכוי של חולה לקבל תשובה חיובית, ועוד הסיכוי להיות בריא כפול הסיכוי של בריא לקבל תשובה חיובית.

התוצאה המפתיעה היא שהסיכוי להיות נשא של הנגיף או חולה גם בבדיקה מאוד מדויקת אם קיבלת תשובה חיובית, הוא פחות מעשרה אחוז. והסיבה לזה נעוצה בסיכוי האפריורי להיות בכלל חולה, שאם לא מתחשבים בו, עלולים להגיע למסקנות מוטעות מאוד.

=== 2. הפרדוקס של סימפסון ===

תופעה הסתברותית נוספת שגם כן קשורה בהסתברות מותנית, יכולה להיות כל כך לא אינטואיטיבית, שיש שמכנים אותה פרדוקס - הפרדוקס של סימפסון.

:::

ניתן פה דוגמא אמיתית אבל עם נתונים מומצאים, על נתוני הקבלה של גברים ונשים לאוניברסיטת ברקלי, ב-1973.

מחקר בדק את הקשר בין מין המועמדים, סיכויי הקבלה שלהם והמחלקה אליה ניסו להתקבל. כששמים את התוצאות בטבלת 2 על 2 ובודקים את הקשר בין מין המועמד לקבלה, מתקבלת תמונה מאוד מוזרה:

בקרב 370 גברים שניסו להתקבל 220 התקבלו כלומר כ60 אחוז. בקרב נשים שניסו להתקבל רק 150 התקבלו, כלומר כ40 אחוז.

אז האם יש הטיה באוניברסיטת ברקלי לקבל יותר גברים?

:::

לא בהכרח! כשמתנים את הנתונים על המחלקה, כלומר רואים את הטבלת 2 על 2 שלנו בנפרד לכל מחלקה, לא רק שגברים לא מופלים לטובה בברקלי, הם אולי אפילו מופלים לרעה!

בנתונים המומצאים שלנו יש לנו שתי מחלקות A ו-B. בקרב המועמדים של מחלקה A 20 מתוך 70 גברים התקבלו, כלומר כ28 אחוזים, ואילו 100 מתוך 300 נשים התקבלו, כלומר כ33 אחוזים.

ואילו במחלקה B 200 מ-300 גברים התקבלו, כ66 אחוזים, ו50 מתוך 70 נשים התקבלו כלומר יותר מ70 אחוזים.

אז איך זה קורה? התשובה נעוצה בהסתברות מותנית שוב. נשים לב שהסיכוי להתקבל במחלקה A מלכתחילה הוא נמוך מאוד, רק 120 מתוך 370, קצת פחות מ33 אחוז. ואילו הסיכוי להתקבל למחלקה B מלכתחילה הוא גבוה יחסית, 250 מתוך 370, כ67 אחוז. ולאן רוב הבנות מנסות להתקבל? למחלקה A, שמאוד קשה להתקבל אליה!

זהו פרדוקס סימפסון: אנחנו רואים איזושהי תופעה, טרנד כשאנחנו מסתכלים על השורה התחתונה של הנתונים, באופן שולי, אבל כשמסתכלים לעומק, בחלוקה לקבוצות, התופעה נעלמת ואולי אפילו מתהפכת.

:::

כמנהגנו ננסה לפרמל את הבעיה ולהשיג יותר תובנות:
מין המועמד יהיה X, הקבלה לברקלי תהיה Y והמחלקה תהיה Z.

מה שאנחנו רואים זה שכשאנחנו מתנים את Y הקבלה על X המין, הסיכוי להתקבל גבוה יותר אצל גברים. אבל:
כשמתנים גם על המשתנה Z כיוון האי-שוויון מתהפך: בקרב המועמדים במחלקה A וגם בקרב המועמדים במחלקה B, הסיכוי להתקבל בקרב נשים  גבוה יותר.

:::

איך זה יכול להיות? הטריק הוא להבין לפי חוק בייס ונוסחת ההסתברות השלמה, שההסתברות שמותנית רק על משתנה אחד, רק על משתנה X המין, היא עדיין ממוצע משוקלל של הסתברויות, כאשר המשקולות הן ההסתברויות המותנות של Z לפי X, או מה הסיכוי מלכתחילה שמועמדות נשים ינסו להתקבל למחלקה A ולמחלקה B. 

נשים מנסות להתקבל יותר למחלקה A שקשה להתקבל אליה, מה שמגדיל הרבה יותר את המשקולת של ההסתברות הקטנה יותר.

:::

באופן כללי אנחנו מסתכלים על קשר בין שלושה משתנים X, Y ו-Z.

אפשר לבחור להתנות משתנה Y בX בלבד או בX וגם בZ.

הפרדוקס הוא שהסתברות של Y להיות 1 בהינתן X1 גדולה יותר מההסתברות של Y בהינתן X2, אבל כשמתנים גם על Z, וזה לכל Z, ההסתברות של Y בהינתן X1 קטנה יותר מההסתברות של Y בהינתן X2.

ואז נשאלת השאלה מה יביא להסתברות גבוהה יותר שY יהיה 1? X1 או X2? התשובה היא שכמובן שX2, בכל רמה של Z הוא מביא להסתברות גבוהה יותר ש-Y יהיה שווה 1.

המפתח הוא להבין שגם הסתברות מותנית על משתנה אחד אפשר לראות כהסתברות שולית שהיא ממוצע משוקלל של הסתברויות מותנות על משתנה נוסף. ואם יש לנו נתונים לגבי משתנה נוסף - אסור לנו להתעלם מהם! אחרת אנחנו יכולים להגיע למסקנות שטחיות ומוטעות.

:::

דוגמא נוספת מהזמן האחרון: תמותה מקורונה.

יש לנו שתי ארצות, איטליה וגרמניה, ודווח בתקשורת שאחוז התמותה מקורונה באיטליה גבוה יותר מאחוז התמותה בגרמניה. יכול להיות שזה נכון. אבל מדען נתונים טוב, יבקש לראות עוד נתונים, לדוגמא גיל.

מסתבר, שאם מסתכלים על אחוז התמותה לפי קבוצות גיל, גם בקרב צעירים וגם בקרב מבוגרים, התופעה מתהפכת, אחוז התמותה בגרמניה גדול יותר!

נסו לחשוב בעזרת מה שלמדנו: איך זה יכול להיות?

:::

נסמן בY את מצב החולה, מת או חי. בX את הארץ, גרמניה או איטליה. ובZ את הגיל, צעיר או מבוגר.

שוב נגדיר מה אנחנו רואים: כשאנחנו מתנים רק על X, הארץ, אחוז המתים באיטליה גבוה יותר.
אבל כשאנחנו מתנים גם על גיל החולה, מתקבלת התופעה ההפוכה: הסיכוי שY החולה ימות באיטליה נמוך יותר, גם בקרב צעירים וגם בקרב מבוגרים.

ומה עומד מאחורי זה? בגרמניה יש הרבה יותר תושבים צעירים! הסיכוי של Z להיות צעיר בהינתן שX הארץ הוא גרמניה, גבוה הרבה יותר מאשר הסיכוי של Z להיות צעיר כשX הארץ הוא איטליה.

והתמותה בקרב צעירים מקורונה היתה נמוכה משמעותית, כלומר בגרמניה יש יותר תושבים עם נטייה למות פחות מקורונה מה שמשפיע על השורה התחתונה ומעוות את התמונה, אם לא מסתכלים גם על משתנה הגיל.

:::

בתרגול תראו שפרדוקס סימפסון מתקיים גם מעבר לשלישיות של משתנים בדידים. כאן אנחנו רואים קשר בין שני משתנים רציפים X ו-Y. כשאנחנו מסתכלים עליהם בצורה חסרה, בצורה שולית, יש קשר יורד בין המשתנים מאוד ברור. אבל אם אנחנו מסתכלים על הקשר בכל תת-קבוצה של משתנה בדיד נוסף Z, התופעה הפוכה, ואנחנו רואים שלמעשה הקשר בין X ל-Y הוא קשר חיובי.

דרך נוחה לחשוב על זה היא באמצעות תוחלת מותנית, שתתרגלו בתרגול. כשאנחנו מסתכלים על התוחלת המותנית של Y בהינתן ערך נמוך X1, אנחנו רואים שהיא גבוהה יותר מאשר התוחלת אם נתון ערך גבוה יותר X2. אבל אם מתנים גם על משתנה נוסף Z, לכל ערך של Z, ההבדל בין התוחלות המותנות מתהפך. Y עולה כש-X עולה, לכל רמה של Z.

=== 3. הרביעייה של אנסקומב ===

התופעה השלישית והאחרונה שנדבר עליה, לאו דוקא קשורה להסתברות מותנית. אבל היא בוודאי ובודאי קשורה להסתכלות שטחית על נתונים.

זוכרים שנתנו עצה תמיד תמיד להעיף מבט בנתונים, רצוי בתרשים, ולא להסתפק בתמציות שמסכמות אותם? בואו נראה מה יכול לקרות אם לא עושים את זה.

:::

סטטיסטיקאי בריטי בשם אנסקומב פרסם רביעיית זוגות נתונים של X ו-Y, במטרה להמחיש מה קורה כשלא מסתכלים על הנתונים.

למרות שכל זוג של X ושל Y שונים לחלוטין, אם מסתכלים רק על מדדים כמו: ממוצע, סטיית תקן, ומתאם, זה נראה שהם זהים לחלוטין.

אנסקומב רצה להדגים גם את הבעייתיות בהסתכלות שטחית על נתונים וגם את הסכנה בתצפיות חריגות, אאוטליירז, כמו שאפשר לראות בזוגות השלישי והרביעי. רוב הנקודות נמצאות בטרנד מסוים, ורק בגלל נקודה אחת שכאילו אינה במקומה מתקבל רושם אחר לגמרי אם מסתכלים רק על המדדים השוליים כמו מתאם למשל. בתרשים השלישי המתאם בין X לY בנכוי התצפית החריגה גדול הרבה יותר מ-0.82, ובתרשים הרביעי הוא קטן הרבה יותר.

:::

לפני כמה שנים עדכנו צמד סטטיסטיקאים את האנליזה של אנסקומב והוסיפו כמו זוגות של X ו-Y מרשימים משלהם. כפי שניתן לראות גם כאן, הממוצעים וסטיות התקן של X ושל Y כמעט זהים וכך גם המתאם ביניהם. אבל הדפוס שונה לחלוטין בכל אחד מזוגות הנתונים!

ואחד מהם הוא אפילו ציור של דינוזאור!

=== 4. סיכום ===

נסכם מה רצינו להגיד ביחידה הזאת:

התפלגויות מותנות הן חשובות מאוד בניתוח נתונים ויכולות להיות מעט לא אינטואיטיביות.

כשמנתחים נתונים, חשוב להציג את כל הנתונים, ולהתנות על כל המשתנים עד כמה שאפשר לפני שמגיעים למסקנות.

לבסוף, תראו כמה חשיבה בצורה פורמלית עזרה לנו. ברגע שאתם מסמנים משתנים באמצעות אותיות ומשתמשים בחוקי ההסתברות אתם יכולים לזקק מסקנות יפות בניתוח נתונים.

:::

נקנח באזהרה אחרונה על כך שהתלות שאנחנו מודדים עם הסתברות מותנית או מתאם, איננה מעידה בהכרח על סיבתיות.

לדוגמא, משתנה X יהיה עישון, ומשתנה Y יהיה לחלות בסרטן ריאות, ואנחנו רואים מתאם גבוה בין שניהם: אנשים שמעשנים יותר, חולים יותר בסרטן הריאות.

אפילו בהינתן שהקשר אמיתי, כל הקשרים שראינו היום היו אמיתיים -- האם נכון לקפוץ להסיק שעישון גורם לסרטן הריאות רק על סמך הסיפור הזה שסיפרתי לכם?

עצרו וחשבו איזה עוד גורם יכול להשפיע על הנתונים האלה.

:::

יכול בהחלט להיות למשל, שאנחנו רואים השפעה של עישון על סרטן ריאות, אבל שזה קורה בגלל שלא הסתכלנו במשתנה מתערב אחר שמשפיע על שניהם כמו מעמד סוציו אקונומי. יכול מאוד להיות שאנשים ממעמד סוציואקונומי נמוך נוטים לעשן יותר, ולאנשים ממעמד סוציואקונומי נמוך יש נטייה לחלות יותר בסרטן הריאות.

כך ששוב אנחנו רואים את השורה התחתונה, השולית, ואם לא נחקור יותר לעומק אנחנו עלולים להגיע למסקנות מוטעות.

:::

סיבתיות או קוזליטי היא תחום מחקר מאוד חם עכשיו - איך אנחנו מבצעים ניסויים שכן יכולים להגיע למסקנה, שתופעה א אכן גורם לתופעה ב ולא בגלל קשר נסיבתי. מי שרוצה לקרוא עוד על התופעה מוזמן לקרוא למשל בספרו המצוין של יהודה פרל, causality. 

בקורס שלנו כאן אנחנו עוצרים.

:::
